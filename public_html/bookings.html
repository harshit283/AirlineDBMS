<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Airline">
    <meta name="viewport" content = "width=device-width, initial-scale=1.0">
    <title>Book Flights</title>
    <link rel="stylesheet" type="text/css" href="materialize/css/materialize.css">
    <script src="materialize/js/jquery.js"></script>
    <script src="materialize/js/materialize.js"></script>
</head>
<body>

<nav class="light-blue darken-4">
    <div class="navbar-wrapper ">
        <a href="/" class="brand-logo left" STYLE="left:5px">Airline</a>
        <ul class="right brand-logo">
            <a href="index.html">Logout</a></ul>
    </div>

</nav>
<br /><br /><br />
<div class="container"  >
    <div class="row ">
        <div class="col s12 m3 l3"></div>
        <div class="col s12 m6 l6 input-field card-content" >
              <select  id="source">
                    <option value="DELHI">DELHI</option>
                    <option value="MUMBAI">MUMBAI</option>
                    <option value="CHENNAI">CHENNAI</option>
                    <option value="KOLKATA">KOLKATA</option>
                    <option value="BANGLORE">BANGALORE</option>
                    <option value="LUCKNOW">LUCKNOW</option>
              </select>
            <label for="source"><h6>SOURCE</h6></label>
            <br>
            <div class="input-field">

                <select id="destination">
                    <option value="DELHI">DELHI</option>
                    <option value="MUMBAI">MUMBAI</option>
                    <option value="CHENNAI">CHENNAI</option>
                    <option value="KOLKATA">KOLKATA</option>
                    <option value="BANGLORE">BANGALORE</option>
                    <option value="LUCKNOW">LUCKNOW</option>
                </select>
                <label for="destination"><h6>DESTINATION</h6></label>
            </div>
            <br>
            <div class="input-field">
                <label for="date" class="active"><h6>Date</h6></label>
                <input type="date" id="date" name="date">
            </div>

            <BR>
            <button class="btn" id="submit">Search Flights</button>

        </div>
        </div>
        <div class="col s12 m3 l3"></div>
    </div>
    <div class="row table-of-contents" id="result">



    </div>
</div>

<footer class="page-footer light-blue darken-4">
    <div class="container">
        <div class="row">
            <div class="col l6 s12">
                <h5 class="white-text">DBMS PROJECT</h5>
                <p class="grey-text text-lighten-4">Airline database system</p>
            </div>
            <div class="col l4 offset-l2 s12">
                <h5 class="white-text">MADE BY </h5>
                <ul>
                    <li><p class="grey-text text-lighten-3" href="#!">Harshit Aggarwal-DTU/2k15/CO/059</p></li>
                    <li><p class="grey-text text-lighten-3" href="#!">Harshit Walia   -DTU/2k15/CO/060</p></li>
                    <li><p class="grey-text text-lighten-3" href="#!">Himanshu Gupta  -DTU/2k15/CO/060</a></li>
                </ul>
            </div>

    </div>
    <div class="footer-copyright">
        <div class="container">
            Â© 2017 Copyright Text
        </div>
    </div>
</footer>

<script>
    $(document).ready(function() {
        $('select').material_select();
        $('#submit').click(function () {

            $('#submit').html("Loading....");
            $('#result').html('');
            var source = $('#source').val();
            var destination = $('#destination').val();
            var date = $('#date').val();
            var obj = {
                source : source,
                destination : destination,
                date : date
            };

            if(source == null || source == '' || destination == '' || destination == null || date == null || date == '')
            {
                alert("Please fill all the details");
                $('#submit').html("Search Flights");
            }
            else
            {
                $.post('/flights/get', obj, function (data, status) {

                    console.log(data.result);
                    if(data.result.length == 0)
                    {
                        $('#result').html("No flights exists");
                    }
                    else {
                     //   $('#result').html(data.result);
                        var str = '<table id="tt" class="responsive-table  bordered blue-text striped"><thead><tr><td>Flight Id</td><td>Date</td><td>Source</td><td>Destination</td><td>Arrival Time</td><td>Departure Time</td><td>Fare</td><td>Available Seats<td></tr></thead>';

                        for(var i = 0 ; i < data.result.length; ++i)
                        {
                            str += '<tr>';
                            str += '<td>'  + data.result[i].flightId+ '</td>';
                            str += '<td>'  + data.result[i].date+ '</td>';
                            str += '<td>'  + data.result[i].source+ '</td>';
                            str += '<td>'  + data.result[i].destination+ '</td>';
                            str += '<td>'  + data.result[i].timeOfArrival+ '</td>';
                            str += '<td>'  + data.result[i].timeOfDeparture+ '</td>';
                            str += '<td>'  + data.result[i].fare+ '</td>';
                            str += '<td>'  + data.result[i].totalAvailable+ '</td>';
                            str += '</tr>';

                        }

                        str += '</table>';
                        $('#result').html(str);
                    }
                    $('#submit').html("Search Flights");



                    /*<table id="tt" class="responsive-table  bordered blue-text striped"><thead><tr>td>Flight Id</td><td>Date</td><td>Source</td><td>Destination</td><td>Arrival Time</td><td>Departure Time</td><td>Fare</td><td>Available Seats<td></tr></thead>
                     */


                });
            }


        });
    });

</script>
</body>
</html>